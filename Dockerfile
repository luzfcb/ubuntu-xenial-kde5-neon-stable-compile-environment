FROM ubuntu:xenial
# from https://cgit.kde.org/sysadmin/ci-tools-experimental.git/tree/docker/neon/Dockerfile

RUN echo "deb http://us.archive.ubuntu.com/ubuntu/ xenial main restricted universe multiverse" >> /etc/apt/sources.list \
    && echo "deb http://archive.neon.kde.org/user xenial main" >> /etc/apt/sources.list.d/neon.list \
    && echo "deb-src http://archive.neon.kde.org/user xenial main" >> /etc/apt/sources.list.d/neon.list \
    && apt-get update && apt-get -y install wget && wget -q -O - http://archive.neon.kde.org/public.key | apt-key add - \
    && apt-get update && apt-get -y dist-upgrade && apt-get update && apt-get upgrade -y && DEBIAN_FRONTEND=noninteractive apt-get -y build-dep qtbase5-dev \
    && rm -rf /var/lib/apt/lists/* && apt-get clean
    
# Dependencies for ALL KDE applications.
RUN apt-get update &&  DEBIAN_FRONTEND=noninteractive apt-get -y --force-yes install \
    appstream \
    astrometry.net \
    bison \
    build-essential \
    bzr \
    clang-3.5 \
    clang-3.6 \
    clang-3.7 \
    clang-3.8 \
    cmake \
    cppcheck \
    dbus-x11 \
    dmz-cursor-theme \
    docbook-xml \
    docbook-xsl \
    doxygen \
    extra-cmake-modules \
    fdupes \
    flex \
    fontforge \
    frei0r-plugins-dev \
    gcovr \
    git \
    gnupg-agent \
    gnupg2 \
    gobject-introspection \
    gperf \
    gpgsm \
    gtk-doc-tools \
    intltool \
    kdelibs5-dev \
    kross-dev \
    ladspa-sdk \
    language-pack-en \
    libaccounts-glib-dev \
    libacl1-dev \
    libapt-pkg-dev \
    libarchive-dev \
    libasound2-dev \
    libatasmart-dev \
    libattr1-dev \
    libavcodec-dev \
    libavdevice-dev \
    libavfilter-dev \
    libavformat-dev \
    libavresample-dev \
    libavutil-dev \
    libblkid-dev \
    libboost1.58-all-dev \
    libbz2-dev \
    libcanberra-dev \
    libcap-dev \
    libcdparanoia-dev \
    libcfitsio3-dev \
    libclang-3.5-dev \
    libclang-3.6-dev \
    libclang-3.7-dev \
    libclang-3.8-dev \
    libcln-dev \
    libclucene-dev \
    libdmtx-dev \
    libeigen2-dev \
    libeigen3-dev \
    libelektra-dev \
    libepoxy-dev \
    libepub-dev \
    libevent-pthreads-2.0-5 \
    libexif-dev \
    libexiv2-dev \
    libfakekey-dev \
    libfam-dev \
    libfarstream-0.2-5 \
    libfluidsynth-dev \
    libgconf2-dev \
    libgcrypt-dev \
    libgettextpo-dev \
    libgif-dev \
    libgirepository1.0-dev \
    libgit2-dev \
    libglew-dev \
    libglib2.0-dev \
    libgpgme++2v5 \
    libgpgme11-dev \
    libgphoto2-dev \
    libgps-dev \
    libgraphicsmagick++1-dev \
    libgraphviz-dev \
    libgsl0-dev \
    libgstreamer-plugins-base1.0-dev \
    libgstreamer1.0-dev \
    libgtk-3-dev \
    libgv-python \
    libhttp-parser-dev \
    libhunspell-dev \
    libical-dev \
    libindi-dev \
    libiodbc2-dev \
    libisocodes-dev \
    libjasper-dev \
    libldap2-dev \
    liblensfun-dev \
    liblmdb-dev \
    libluajit-5.1-dev \
    liblzma-dev \
    libmagick++-dev \
    libmovit-dev \
    libmtp-dev \
    libmusicbrainz3-dev \
    libncurses5-dev \
    libnm-dev \
    libnm-glib-dev \
    libnm-glib-vpn-dev \
    libnm-gtk-dev \
    libnm-util-dev \
    libnss3-dev \
    libofx-dev \
    libopenal-dev \
    libopencv-core-dev \
    libopenexr-dev \
    libotr5-dev \
    libpam0g-dev \
    libparted-dev \
    libpci-dev \
    libpgf-dev \
    libphonon4qt5-dev \
    libpocketsphinx-dev \
    libpodofo-dev \
    libpolkit-agent-1-dev \
    libpolkit-backend-1-dev \
    libpolkit-gobject-1-dev \
    libpostproc-dev \
    libprotobuf-dev \
    libqalculate-dev \
    libqrencode-dev \
    libraw-dev \
    librdf-storage-virtuoso \
    librdf0-dev \
    libsamplerate0-dev \
    libsane-dev \
    libsasl2-dev \
    libsdl1.2-dev \
    libshp-dev \
    libslp-dev \
    libsmbclient-dev \
    libsndfile1-dev \
    libsox-dev \
    libspectre-dev \
    libspeechd-dev \
    libspnav-dev \
    libsqlcipher-dev \
    libssh2-1-dev \
    libstemmer-dev \
    libsvn-dev \
    libswresample-dev \
    libswscale-dev \
    libsystemd-dev \
    libtag1-dev \
    libtelepathy-farstream-dev \
    libtelepathy-glib-dev \
    libtelepathy-logger-dev \
    libtidy-dev \
    libtool \
    libvcdinfo-dev \
    libvncserver-dev \
    libwlocate-dev \
    libx11-dev \
    libxapian-dev \
    libxbase64-dev \
    libxcb-composite0-dev \
    libxcb-cursor-dev \
    libxcb-damage0-dev \
    libxcb-dpms0-dev \
    libxcb-util0-dev \
    libxcb-xinerama0-dev \
    libxcb-xtest0-dev \
    libxerces-c-dev \
    libxine2-dev \
    libxkbfile-dev \
    libxml2-dev \
    libxmu-dev \
    libxslt1-dev \
    libxss-dev \
    libxt-dev \
    libyaml-dev \
    media-player-info \
    mercurial \
    mesa-utils \
    mobile-broadband-provider-info \
    modemmanager-dev \
    mono-mcs \
    mysql-server \
    network-manager-dev \
    openbox \
    openjdk-8-jdk \
    openssh-server \
    p7zip \
    packagekit \
    pkg-kde-tools \
    postgresql \
    protobuf-compiler \
    psmisc \
    python-jinja2 \
    python-lxml \
    python-numpy \
    python-yaml \
    python2.7-dev \
    python3-dev \
    python3-jinja2 \
    python3-numpy \
    python3-yaml \
    python3.5-dev \
    r-base-dev \
    ragel \
    ruby \
    ruby-dev \
    samba-common \
    sip-dev \
    sphinxsearch \
    sqlcipher \
    sqlite3 \
    ssh \
    subversion \
    swig \
    texinfo \
    texlive-latex-recommended \
    unar \
    rar \
    unrar \
    unzip \
    virtuoso-opensource \
    wcslib-dev \
    weston \
    xinput \
    xmlto \
    xplanet \
    xsdcxx \
    swig3.0 \
    xserver-xephyr \
    xserver-xorg-input-wacom \
    xsltproc \
    xwayland \
    && rm -rf /var/lib/apt/lists/* && apt-get clean

RUN mkdir -p /var/run/sshd
#RUN groupadd -g 1000 jenkins
#RUN useradd -m -u 1000 -g 1000 -d /home/jenkins jenkins
#RUN echo 'jenkins:1234' | chpasswd #changeme

RUN echo "eval \`dbus-launch --auto-syntax 2>&1\`" > ~/.bashrc
RUN mkdir /tmp/xdg-runtime-dir
#RUN chown jenkins.jenkins /tmp/xdg-runtime-dir
#USER root
#RUN sed s,exit\ 101,exit\ 0, /usr/sbin/policy-rc.d -i
#RUN dpkg-reconfigure openssh-server
#EXPOSE 22
WORKDIR /app_src

CMD ["/bin/bash"]
